<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>VoFo Music | Private Listening</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600&family=Playfair+Display:ital,wght@0,400;0,700;1,400&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
<style>
:root{
    --bg:#0a0a0a; --gold:#c5a367; --soft:#f8f8f8; --muted:#777;
}
*{box-sizing:border-box;margin:0;padding:0}
body{
    background:radial-gradient(circle at 50% 40%, #1c1c1c 0%, #0a0a0a 100%);
    color:var(--soft); font-family:'Inter',sans-serif; min-height:100vh; display:flex; flex-direction:column;
}

/* Hero */
.hero{flex:1; display:flex; flex-direction:column; justify-content:center; align-items:center; text-align:center; padding:40px 20px;}
.est{font-size:12px; letter-spacing:.4em; text-transform:uppercase; color:var(--gold); margin-bottom:20px;}
h1{font-family:'Playfair Display',serif; font-size:clamp(3.5rem,10vw,6rem); background:linear-gradient(to bottom,#fff,#aaa); -webkit-background-clip:text; -webkit-text-fill-color:transparent; font-weight:400; margin-bottom:20px;}
.sub{font-size:12px; letter-spacing:.3em; text-transform:uppercase; color:var(--muted); margin-bottom:40px;}

/* Search */
.search-box{width:100%; max-width:500px;}
.search-box input{width:100%; padding:18px; text-align:center; font-size:1rem; border-radius:4px; border:1px solid rgba(255,255,255,.1); background:rgba(255,255,255,.03); color:white; margin-bottom:15px;}
.search-box input:focus{outline:none; border-color:var(--gold); box-shadow:0 0 15px rgba(197,163,103,.15);}
.search-box button{width:100%; padding:16px; background:var(--gold); border:none; font-weight:600; letter-spacing:.15em; text-transform:uppercase; cursor:pointer; transition:.3s;}
.search-box button:disabled{opacity:.5; cursor:not-allowed;}
#results{width:100%; max-width:800px; margin-top:50px; display:flex; flex-direction:column; gap:10px;}
.track{padding:15px; display:flex; align-items:center; gap:15px; border-radius:8px; background:rgba(255,255,255,.03); cursor:pointer; transition:.3s; text-align:left;}
.track:hover{background:rgba(197,163,103,.1); transform:translateX(10px);}
.track img{width:50px; height:50px; border-radius:4px; object-fit:cover;}

/* Player */
.player{position:fixed; bottom:0; width:100%; background:rgba(0,0,0,.85); backdrop-filter:blur(20px); padding:15px 20px; display:flex; gap:20px; align-items:center; border-top:1px solid rgba(197,163,103,0.2); z-index:100;}
.hidden{display:none;}
#progress, #volume{-webkit-appearance:none; width:100%; height:4px; border-radius:2px; background: rgba(197,163,103,0.2); cursor:pointer;}
#progress::-webkit-slider-thumb, #volume::-webkit-slider-thumb{-webkit-appearance:none; width:12px; height:12px; border-radius:50%; background:var(--gold); cursor:pointer;}

/* Footer */
footer{padding:30px 20px; background:rgba(0,0,0,.5); border-top:1px solid rgba(255,255,255,.05);}
.footer-wrap{max-width:1200px; margin:auto; display:grid; grid-template-columns:2fr 1fr 1fr; gap:40px;}
.footer-brand{font-family:'Playfair Display',serif; color:var(--gold); font-size:1.6rem;}
.footer-links h5{font-size:11px; letter-spacing:.2em; color:#777; margin-bottom:20px; text-transform:uppercase;}
.footer-links a{display:block; color:#aaa; text-decoration:none; margin-bottom:12px;}
.copyright{margin-top:30px; text-align:center; font-size:12px; color:#444;}
.copyright span{color:var(--gold);}
@media(max-width:768px){.footer-wrap{grid-template-columns:1fr;} .player{flex-direction:column; text-align:center;}}
</style>
</head>
<body>

<div class="hero">
    <div class="est">PRIVATE MUSIC PLATFORM</div>
    <h1>VoFo</h1>
    <div class="sub">HIGH-FIDELITY · NO ADS · NO TRACKING</div>
    <div class="search-box">
        <input id="searchInput" placeholder="Search artist, track or mood…" autocomplete="off">
        <button id="searchBtn" onclick="doSearch()">EXPLORE</button>
    </div>
    <div id="results"></div>
</div>

<div class="player hidden" id="player">
    <img id="playerThumb" style="width:50px; height:50px; border-radius:4px;">
    <div style="flex:1; display:flex; flex-direction:column; gap:8px;">
        <div id="trackTitle" style="font-weight:600; font-size:14px;"></div>
        <div id="trackArtist" style="font-size:11px;color:#777; text-transform: uppercase; letter-spacing:1px;"></div>
        <input type="range" id="progress" value="0" min="0" max="100" step="0.1">
        <div style="display:flex; align-items:center; gap:15px;">
            <button id="playBtn" style="padding:5px 15px; background:var(--gold); border:none; border-radius:4px; cursor:pointer; font-weight:bold; font-size:10px;">PAUSE</button>
            <input type="range" id="volume" min="0" max="1" step="0.01" value="0.8" style="width:80px;">
        </div>
    </div>
</div>

<footer>
<div class="footer-wrap">
    <div>
        <div class="footer-brand">VoFo Music</div>
        <p style="color:#666;max-width:300px;margin-top:10px;font-size:13px;">
            A private high-fidelity music experience built for purity of sound.
        </p>
    </div>
    <div class="footer-links">
        <h5>Platform</h5>
        <a href="#">Discover</a>
        <a href="#">Genres</a>
    </div>
    <div class="footer-links">
        <h5>Connect</h5>
        <a href="#">SoundCloud</a>
        <a href="#">Support</a>
    </div>
</div>
<div class="copyright">
    © 2026 VOFO MUSIC · ENGINEERED BY <span>ABHIRAM</span> IN COLLAB WITH <span>PLBYZ</span> · ALL RIGHTS RESERVED
</div>
</footer>

<script>
const audio = document.createElement("audio");
document.body.appendChild(audio);
let hls = null;

const playBtn = document.getElementById("playBtn");
const progress = document.getElementById("progress");
const volume = document.getElementById("volume");
const trackTitle = document.getElementById("trackTitle");
const trackArtist = document.getElementById("trackArtist");
const playerThumb = document.getElementById("playerThumb");
const player = document.getElementById("player");
const searchBtn = document.getElementById("searchBtn");

async function doSearch(){
    const q = searchInput.value;
    if(!q) return;
    searchBtn.innerText="DIGGING...";
    searchBtn.disabled=true;
    try{
        const res = await fetch(`/api/search?q=${encodeURIComponent(q)}`);
        const data = await res.json();
        const resultsDiv = document.getElementById("results");
        resultsDiv.innerHTML="";
        data.forEach(song=>{
            const div=document.createElement("div");
            div.className="track";
            div.innerHTML=`<img src="${song.thumbnail || ''}" onerror="this.style.display='none'">
                             <div><div style="font-weight:600">${song.title}</div>
                             <div style="font-size:12px; color:var(--muted)">${song.artist}</div></div>`;
            div.onclick=()=>playSong(song);
            resultsDiv.appendChild(div);
        });
    } catch(e){console.error(e);} finally{searchBtn.innerText="EXPLORE"; searchBtn.disabled=false;}
}

async function playSong(song){
    player.classList.remove("hidden");
    trackTitle.innerText=song.title;
    trackArtist.innerText=song.artist;
    playerThumb.src=song.thumbnail;
    try{
        const res = await fetch("/api/play",{
            method:"POST",
            headers:{"Content-Type":"application/json"},
            body:JSON.stringify({url:song.id})
        });
        const data = await res.json();

        if(hls){ hls.destroy(); hls=null; audio.src=""; }

        const playAudio = () => { audio.play().catch(()=>{}); };

        if(Hls.isSupported() && data.stream_url.includes(".m3u8")){
            hls = new Hls();
            hls.loadSource(data.stream_url);
            hls.attachMedia(audio);
            hls.on(Hls.Events.MANIFEST_PARSED, playAudio);
        } else {
            audio.src=data.stream_url;
            playAudio();
        }
        playBtn.innerText="PAUSE";
    } catch(e){console.error(e);}
}

playBtn.addEventListener("click",()=>{
    if(audio.paused){ audio.play().catch(()=>{}); playBtn.innerText="PAUSE"; }
    else{ audio.pause(); playBtn.innerText="PLAY"; }
});

audio.addEventListener("timeupdate",()=>{
    if(audio.duration) progress.value=(audio.currentTime/audio.duration)*100;
});

progress.addEventListener("input",()=>{ if(audio.duration) audio.currentTime=(progress.value/100)*audio.duration; });
volume.addEventListener("input",()=>{ audio.volume=volume.value; });
searchInput.addEventListener("keydown", e=>{ if(e.key==="Enter") doSearch(); });
</script>

</body>
</html>
